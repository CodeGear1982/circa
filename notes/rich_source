
Need to rewrite all the existing source-reproduction stuff, but allow for rich formatting.

Goals:
 - Easy conversion from rich-text to plain source. Eventually replace the plain source version.
 - No wasteful string duplication.
 - Each text snippet can be colored, hovered over, and clicked.
 - Ability to add more annotations as needed.
 - Section rewriting is efficient.


Every item should have:
 - String contents
 - Ref to relevant term
 - Highlight class

Data format:
  Block = List<Line>
  Line = [Ref term, List<Phrase>] (each term from source branch corresponds to 1 line)
  Phrase = [String contents, Ref term, PhraseType type]

Internal api:

Block create_block()

Line Block.append_line(Block, Term* term)

Line.append_phrase(String str, PhraseType type, Term* term)
