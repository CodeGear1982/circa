
def left()
  def nested()

  state b = nested.block

def right()
  def nested()

  state b = null

  assert(b == nested.block)

int = make_vm(left)
int.run

int.migrate_to(right)
int.run

assert(int.top.block == right.block)
